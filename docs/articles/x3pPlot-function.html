<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="impressions">
<title>Using and tweaking x3pPlot() • impressions</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using and tweaking x3pPlot()">
<meta property="og:description" content="impressions">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">impressions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/x3pPlot-function.html">Using and tweaking x3pPlot()</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using and tweaking x3pPlot()</h1>
            
      
      
      <div class="d-none name"><code>x3pPlot-function.Rmd</code></div>
    </div>

    
    
<p>The <code><a href="../reference/x3pPlot.html">x3pPlot()</a></code> (or <code><a href="../reference/x3pPlot.html">x3p_plot()</a></code>) function
creates a visualization of one or more x3p objects using the
<code>ggplot2</code> package.</p>
<p>We use base <code>ggplot2</code> in <code><a href="../reference/x3pPlot.html">x3pPlot()</a></code>, so you
can easily change these settings if you’re already familiar. The
<code><a href="../reference/x3pPlot.html">x3pPlot()</a></code> function essentially consists of a call to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster()</a></code> with possible faceting and setting default
features such as the pixel color scale, legend, etc. In this vignette,
we discuss how to change characteristics of the plot.</p>
<div class="section level2">
<h2 id="basic-usage-of-x3pplot">Basic usage of <code>x3pPlot</code><a class="anchor" aria-label="anchor" href="#basic-usage-of-x3pplot"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">impressions</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"K013sA1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"K013sA2"</span><span class="op">)</span></span></code></pre></div>
<p>First, let’s make sure that we understand the basic functionality of
<code><a href="../reference/x3pPlot.html">x3pPlot()</a></code>. This section will discuss how the arguments of
<code><a href="../reference/x3pPlot.html">x3pPlot()</a></code> change the output, which expose some of the
underlying <code>ggplot2</code> functionality. Those familiar with
<code>ggplot2</code> can ignore these arguments, and consequently this
section, by simply adding (<code>+</code>) desired changes to the
<code>ggplot2</code> object returned by <code><a href="../reference/x3pPlot.html">x3pPlot()</a></code>. The
sections after this one show how you can extend the functionality of
<code><a href="../reference/x3pPlot.html">x3pPlot()</a></code> using <code>ggplot2</code>.</p>
<p>The <code>x3pPlot</code> function takes as its first argument(s) a
sequence or list of x3p objects. The code below demonstrates what we
mean by a “sequence” in that they can be separated by commas. We see
that the output visualizes the surface values of the two x3p objects on
the same color scale using faceting. If not specified, the facet labels
are set to <code>x3p[0-9]{1,}</code> up to the number of x3p objects
passed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/x3pPlot.html">x3pPlot</a></span><span class="op">(</span><span class="va">K013sA1</span>,<span class="va">K013sA2</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-2-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Wrapping these objects within a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> provides the
exact same output.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;We provide this flexibility of input because of the two
expected use cases. One common use case will be that you have an x3p
object loaded directly into your environment (e.g., by running
&lt;code&gt;data("K013sA1")&lt;/code&gt; as in this vignette). In this case, it’s
nicer to pass the name of the object directly into the
&lt;code&gt;&lt;a href="../reference/x3pPlot.html"&gt;x3pPlot()&lt;/a&gt;&lt;/code&gt; function rather than wrapping it first in a list.
The second expected use case is when you have a list of x3p objects
stored in the column of a data frame-like object such as a
&lt;code&gt;&lt;a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link"&gt;tibble()&lt;/a&gt;&lt;/code&gt; – this is the case when comparing cartridge cases
using the &lt;code&gt;cmcR&lt;/code&gt; or &lt;code&gt;scored&lt;/code&gt; packages. In this
case, it’s easier to pass the whole column, like &lt;code&gt;df$x3pCol&lt;/code&gt;,
than flattening the column first.&lt;/p&gt;'><sup>1</sup></a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># exact same output as above, so not shown:</span></span>
<span><span class="co"># x3pPlot(list(K013sA1, K013sA2))</span></span></code></pre></div>
<div class="section level3">
<h3 id="x3p-names-argument">
<code>x3p.names</code> argument<a class="anchor" aria-label="anchor" href="#x3p-names-argument"></a>
</h3>
<p>The other arguments in <code><a href="../reference/x3pPlot.html">x3pPlot()</a></code> change characteristics
of the plot. First, we can change the facet labels; either by setting
the <code>x3p.names</code> object or by passing a named list. Note that
<code>x3p.names</code> is ignored if a named list is used.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/x3pPlot.html">x3pPlot</a></span><span class="op">(</span><span class="va">K013sA1</span>,<span class="va">K013sA2</span>,x3p.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Scan A"</span>,<span class="st">"Scan B"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-4-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># exact same output as above, so not shown:</span></span>
<span><span class="co"># x3pPlot(list("Scan A" = K013sA1, "Scan B" = K013sA2))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="output-argument">
<code>output</code> argument<a class="anchor" aria-label="anchor" href="#output-argument"></a>
</h3>
<p>The <code>output</code> argument specifies whether the x3p objects
are visualized on the same color scale using faceting, or if each x3p
object is visualized on its own color scale and the output is a list.
The former is useful for comparing the surface values across two or more
scans. The latter output is useful if you have x3p objects whose surface
values are on different scales, meaning one scan’s surface values would
“drown out” others.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/x3pPlot.html">x3pPlot</a></span><span class="op">(</span><span class="va">K013sA1</span>,<span class="va">K013sA2</span>,output <span class="op">=</span> <span class="st">"list"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $x3p1</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-5-1.png" width="60%" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x3p2</span></span></code></pre>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-5-2.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="height-colors-height-quantiles-and-na-value-arguments">
<code>height.colors</code>, <code>height.quantiles</code>, and
<code>na.value</code> arguments<a class="anchor" aria-label="anchor" href="#height-colors-height-quantiles-and-na-value-arguments"></a>
</h3>
<p>By default, the color scheme used in <code><a href="../reference/x3pPlot.html">x3pPlot()</a></code> is a
mapping of the x3p object surface value quantiles to a divergent purple,
white, orange color scale. The median surface value is mapped to white
(technically a very light gray) while values below/above the median are
mapped to progressively darker shades of purple/orange, respectively.
The <code>na.value</code> argument is set to <code>"gray65"</code> by
default. The image below summarizes the mapping between 11 surface
quantiles and hexidecimal colors. We chose this mapping because we found
that it highlighted the distinguishable markings on a cartridge case
surface well.</p>
<p><img src="images/x3pPlot-colorscheme.png" style="width:100.0%" align="center"></p>
<p>The <code>height.colors</code> and <code>height.quantiles</code>
arguments allow you to change the color scale and quantile mapping. For
example, the code below maps equally-spaced quantiles to grayscale. This
color scale doesn’t distinguish between values below or above the median
surface value. We also change the <code>na.value</code> argument for
illustration.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/x3pPlot.html">x3pPlot</a></span><span class="op">(</span><span class="va">K013sA1</span>,<span class="va">K013sA2</span>,</span>
<span>        height.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gray"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        height.quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>        na.value <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-6-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="legend-quantiles-and-legend-length-arguments">
<code>legend.quantiles</code> and <code>legend.length</code>
arguments<a class="anchor" aria-label="anchor" href="#legend-quantiles-and-legend-length-arguments"></a>
</h3>
<p>Keen eyes may be twitching at the plot legends in the previous
examples. The tick marks on the plot legend are spaced such that the
first, second, and third quartile labels are bunched-up and overlapping.
We can give the legend quantile labels some breathing room using the
<code>legend.quantiles</code> argument. We can also adjust the legend
length using the <code>legend.length</code> argument, which internally
is passed to the <code>barheight</code> argument of
<code><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/x3pPlot.html">x3pPlot</a></span><span class="op">(</span><span class="va">K013sA1</span>,<span class="va">K013sA2</span>,</span>
<span>        legend.quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.01</span>,<span class="fl">.5</span>,<span class="fl">.99</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"in"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-7-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="color-scale">Color scale<a class="anchor" aria-label="anchor" href="#color-scale"></a>
</h2>
<p>We’ve already discussed how you can redefine the quantile color scale
mapping in the <code><a href="../reference/x3pPlot.html">x3pPlot()</a></code> function. If you want to change to
a color scale that isn’t based on quantiles, then you can simply
overwrite the old color scale using your choice of
<code>scale_fill_*</code> function. The
<code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2()</a></code> example below illustrates why the
previous quantile mapping is useful – most of the surface values
<em>aren’t</em> extreme or distinguishable, so the quantile mapping
makes the less populous, more interesting impressions more visible. Note
that you will get a warning for overwriting the previous color scale
that you can suppress by wrapping the visualization call as
<code>suppressWarning(print(...))</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x3pPlot.html">x3pPlot</a></span><span class="op">(</span><span class="va">K013sA1</span>,<span class="va">K013sA2</span>,legend.length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"in"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"purple"</span>,mid <span class="op">=</span> <span class="st">"white"</span>,high <span class="op">=</span> <span class="st">"darkorange"</span>,midpoint <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-8-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="legend">Legend<a class="anchor" aria-label="anchor" href="#legend"></a>
</h3>
<p>The legend can be changed using <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code> and/or
<code><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar()</a></code> as below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colourbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>,<span class="st">"in"</span><span class="op">)</span>,</span>
<span>                                barheight <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="st">"in"</span><span class="op">)</span>,</span>
<span>                                title <span class="op">=</span> <span class="st">"New Title"</span>,</span>
<span>                                title.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                                label.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>                                label.theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                                                                    angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>                                title.theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>                                frame.colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                                ticks.colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-9-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="axis-features">Axis Features<a class="anchor" aria-label="anchor" href="#axis-features"></a>
</h2>
<p>We hide the axis information by default. However you might want to
include axis text or ticks. You can add a new theme to the plot to
override the previous settings. We prefer <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal()</a></code>,
but you do you.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-10-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Note that the axis text below shows <em>pixel</em>-wise increments by
default. If you instead want to show the physical size of each scan, say
in micrometers (“microns” or <span class="math inline">\(\mu\)</span>m
for short), then you’ll need information about the scan resolution. In
this example, both scans <code>K013sA1</code> and <code>K013sA2</code>
have a lateral resolution of approximately <span class="math inline">\(7.4 \times 10^{-6}\)</span> meters, or 7.4
micrometers, per pixel as you can see in the <code>incrementY</code> (or
<code>incrementX</code>) element of the x3p objects. We use
<code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous()</a></code>
to change the axis labels to the micron scale. Notice how we use the
<code><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression()</a></code> function for the <span class="math inline">\(\mu\)</span>m abbreviation. We see that both scans
are approximately 3000 <span class="math inline">\(\mu\)</span>m in both
directions.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K013sA1</span><span class="op">$</span><span class="va">header.info</span><span class="op">$</span><span class="va">incrementY</span> <span class="co">#same as incrementX</span></span>
<span><span class="co">#&gt; [1] 7.37364e-06</span></span>
<span><span class="co"># K013sA2$header.info$incrementY # same as above</span></span>
<span></span>
<span><span class="va">plt</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">K013sA1</span><span class="op">$</span><span class="va">header.info</span><span class="op">$</span><span class="va">incrementX</span><span class="op">*</span><span class="fl">1e6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">y</span><span class="op">*</span><span class="va">K013sA1</span><span class="op">$</span><span class="va">header.info</span><span class="op">$</span><span class="va">incrementY</span><span class="op">*</span><span class="fl">1e6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Horizontal Extent ["</span><span class="op">*</span><span class="va">mu</span><span class="op">*</span><span class="st">"m]"</span><span class="op">)</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Vertical Extent ["</span><span class="op">*</span><span class="va">mu</span><span class="op">*</span><span class="st">"m]"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-11-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="faceting">Faceting<a class="anchor" aria-label="anchor" href="#faceting"></a>
</h2>
<p>Faceting allows multiple x3p objects to be visualized on the same
color scale, which makes it easier to compare their surface values. You
can change the nature of the faceting by adding
<code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid()</a></code>, which will
overwrite the previous settings. Within the <code><a href="../reference/x3pPlot.html">x3pPlot()</a></code>
function, we convert each x3p object into a data frame and add a column
called <code>x3p</code> that tracks the label associated with each scan.
You can facet the plot on this <code>x3p</code> column. In the example
below, you can see how the output changes depending on the faceting
function used.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">x3p</span>,ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-12-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">plt</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">x3p</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-12-2.png" width="60%" style="display: block; margin: auto;"></p>
<p>We can also change the facet labeling using <code><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller()</a></code>
as in the example below.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">x3p</span>,</span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>x3p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x3p1 <span class="op">=</span> <span class="st">"Scan A"</span>,</span>
<span>                                         x3p2 <span class="op">=</span> <span class="st">"Scan B"</span><span class="op">)</span>,</span>
<span>                                 .default <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">string</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">string</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="x3pPlot-function_files/figure-html/unnamed-chunk-13-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://jzemmels.github.io/" class="external-link">Joseph Zemmels</a>, <a href="https://github.com/heike" class="external-link">Heike Hofmann</a>, <a href="https://srvanderplas.netlify.app/" class="external-link">Susan VanderPlas</a>, <a href="https://forensicstats.org/" class="external-link">CSAFE</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
